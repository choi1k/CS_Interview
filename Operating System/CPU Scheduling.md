# CPU Scheduling

### CPU Scheduling

  * CPU Scheduling이란?
  
    컴퓨터 시스템의 자원을 효율적으로 관리하기 위해 프로세스들 사이에서 CPU 할당을 위한 우선순위를 관리하는 일
    
    다중 프로그래밍을 지원하는 OS에서 프로세서(CPU)를 효율적으로 관리하기 위해 필요함
    
  * CPU Scheduling의 목적

    * 공정한 스케줄링
        
    * 처리량 극대화
        
    * 응답시간 최소화
        
    * 균형있는 자원 사용
        
    * 실행의 무기한 연기 배제
        
    * 반환시간 예측

  * 스케줄링 성능 지표(Scheduling Criteria)

        1. CPU 활용율(CPU utilization) : 시간당 CPU를 사용한 시간의 비율
        2. 처리량(Throughput) : CPU가 단위 시간당 처리하는 프로세스 개수
        3. 대기 시간(Waiting Time) : 프로세스가 Ready Queue에서 대기하는 시간의 총합
        4. 응답 시간(Response Time) : Ready Queue에서 처음으로 CPU를 할당받을 때까지 걸린 시간
        5. 반환 시간(Turnaround Time) : 프로세스가 생성되고 종료된 후 사용하던 자원을 모두 반환하는 데까지 걸린 시간

  * 선점 vs 비선점

    * 선점

      한 프로세스가 CPU를 할당받아 실행중이라도 다른 프로세스가 현재 프로세스를 중지 시키고 CPU를 강제적으로 뺏을 수 있는 스케줄링 방식
      
      ex) Multilevel-Queue, Multilevel-Feedback-Queue, SRTF, RR, 우선순위 스케줄링(선점)
      
    * 비선점

      한 프로세스가 CPU를 할당받아 실행중이라면 다른 프로세스들이 CPU를 강제적으로 뺏을 수 없는 스케줄링 방식
      
      ex) FCFS, SJF, HRN, 우선순위 스케줄링(비선점)

### 비선점 스케줄링

  * FCFS(First-Come First-Served)

    먼저 요청한 프로세스 순으로 스케줄링\
    
    * 장점
        
      높은 자원 효율성\
      일괄처리 시스템에 적합
      
    * 단점
      
      프로세서를 장시간 독점하는 경우 오랜 시간을 기다림(= 평균 응답 시간이 길어짐)\
      대화형 시스템에 부적합
  
  * SJF(Shorteds-Job First)

    CPU 작업 시간이 가장 짧은 프로세스 순으로 스케줄링\
    작업 시간이 동일할 경우 FCFS 방식을 따름\
      
    * 장점
    
        평균 대기 시간 최소화\
        시스템 내의 대기 프로세스 수 최소화\
        많은 프로세스에 빠른 응답 시간 제공
        
    * 단점
    
      무기한 연기 발생\
      프로세스 생성 시 총 실행 기간에 대한 정확한 계산 불가능

  * HRN(Hightest Response-ratio Next)

    우선순위를 계산하여 점유 불평등을 보완한 스케줄링(SJF의 단점 보완)\
    우선순위 = (대기 시간 + 실행 시간) / 실행 시간\
    
    * 장점
    
      실행 시간이 긴 작업과 짧은 작업 간의 불평등 보완\
      짧은 작업이나 대기시간이 긴 작업은 우선순위 상승(SJF 단점 보완)
      시분할 시스템에 적합
      
    * 단점
    
      Ready Queue에 있는 각 프로세스의 서비스 시간을 지속적으로 추적함으로써 오버헤드 증가

### 선점 스케줄링

  * Multilevel-Queue(다단계 큐)

    프로세스를 여러 종류의 그룹으로 나누어 여러 개의 큐를 이용하는 기법\
    각 큐는 각자의 스케줄링 방식을 가지고 있음\
    우선순위가 낮은 큐가 실행되지 못하는 걸 방지하고자 각 큐마다 다른 Time Quantum을 설정\
    우선순위가 높은 큐는 작은 Time Quantum을, 우선순위가 낮은 큐는 큰 Time Quantum을 할당\
    
    * 장점
      
      큐 간의 프로세스 이동이 불가능하기 때문에 스케줄링 부담이 적음
      
    * 단점

      큐 간의 프로세스 이동이 불가능 하므로 유연성이 
      우선순위가 낮은 프로세스에 Starvation이 발생할 수 있음
      
  * Multilevel-Feedback-Queue(다단계 피드백 큐)

    다단계 큐 + 우선순위 변화 적용\
    다단계 큐와 달리 큐 간의 프로세스 이동이 가능함
    
    등록된 프로세스는 FCFS 방식으로 CPU를 할당받아 실행됨\
    자신의 Time Quantum을 다 채운 프로세스는 한 단계 아래의 Ready Queue로 내려감\
    단계가 내려갈수록 Time Quantum이 증가함\
    
    * 장점
      
      입출력 위주(interrupt가 잦은) 작업에 우선권을 줌
      처리 시간이 짧은 프로세스를먼저 처리하기 때문에 반환 시간의 평균을 줄여줌
      오래 대기한 큐에 Aging 기법을 활용해 Starvation을 예방함
  
    * 단점
    
      설계와 구현이 매우 복잡함
      
  * SRTF(Shortest-Rmaining-time First)

    선점 SJF 방식
    
    * 장점
      
      평균 대기시간 최소화
      
    * 단점
    
      프로세스 생성 시 총 실행 시간 추정 작업 필요\
      잦은 선점으로 Context Switching 오버헤드 증대\
      실행 시간이 긴 프로세스들의 평균 응답 시간이 길이어짐

  * RR(Round-Robin)

    시분할 시스템에서 사용\
    time slice라는 시간을 정의해 해당 시간이 경과할 때마다 현재 프로세스를 중단하고 다음 프로세스를 실행\
    
    * 장점
      
      응답 시간이 짧아 대화형 시스템에 적합
      
    * 단점
    
      time slice에 따라 성능이 달라짐\
      time slice 크기가 매우 크면 FCFS 방식과 큰 차이가 없고 매우 작으면 Context Switching이 자주 발생함

  * 우선순위 스케줄링

    우선순위가 높은 프로세스 순으로 CPU 할당\
    우선순위가 같으면 FCFS 방식을 따름\
    수가 작을수록 우선순위가 높음\
    Aging 방법으로 Starvation 문제 해결
    선점/비선점 방식
    
    * 장점
    
      각 프로세스의 상대적 중요성을 정확히 정의 할 수 있음\
      실시간 시스템에 사용 가능
      
    * 단점
    
      우선순위가 낮은 프로세스의 경우 영구 대기 또는 Starvation 발생
