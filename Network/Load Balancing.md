# Load Balancing

로드 밸런싱, 부하 균등화


<br>

>둘 이상의 CPU or 저장장치와 같은 컴퓨터 자원들에게 작업을 나누는 것

<br>


![image](https://user-images.githubusercontent.com/75096085/214342890-63bc451a-1556-489c-8200-89bd40558145.png)

<br>


요즘 시대에는 웹사이트에 접속하는 인원이 급격히 늘어나게 됨.

따라시 이 사람들에 대해 모든 트래픽을 감당하기엔 1대의 서버로는 부족함. 

<br>

<br>

### 대응방안

- **Scale-up**: 하드웨어의 성능을 올림
- Scale-out: 여러 대의 서버가 나눠서 일하도록 만듦

<br>

하드웨어 향상 비용이 더욱 비싸기도 하고, 서버가 여러대면 무중단 서비스를 제공하는 환경 구성이 용이하므로 Scale-out이 효과적임. 이때 여러 서버에게 균등하게 트래픽을 분산시켜주는 것이 바로 `로드 밸런싱`임.

<br>

로드 밸런싱은 분산식 웹 서비스로, 여러 서버에 부하(Load)를 나누어주는 역할을 함.

로드 밸런서를 클라이언트와 서버 사이에 두고, 부하가 일어나지 않도록 여러 서버에 분산시켜주는 방식

서버를 운영하는 사이트의 규모에 따라 웹 서버를 추가로 증설하면서 로드 밸런서로 관리해주면 웹 서버의 부하를 해결할 수 있음

<br>

<br>

## 로드 밸런서가 서버를 선택하는 방식

<br>

- 라운드 로빈: CPU 스케쥴링의 라운드 로빈 방식 활용
- Least Connections: 연결 개수가 가장 적은 서버 선택 (트래픽으로 인해 세션이 길어지는 경우 권장)
- Source: 사용자 IP를 해싱하여 분배 (특정 사용자가 항상 같은 서버로 연결되는 것 보장)


<br>

<br>

## 로드 밸런서 장애 대비

<br>

서버를 분배하는 로드 밸런서에 문제가 생길 수 있기 때문에 로드 밸런서를 이중화하여 대비

<br><br>


구글이나 마이크로소프트 데이터 센터와 같은 클라우드 데이터 센터는 검색, 전자메일, 비디오 애플리케이션 등 여러 애플리케이션을 동시에 제공함. 외부 클라이언트로부터의 요청을 지원하기 위해서, 애플리케이션에는 공용(Public) IP주소가 할당되며 클라이언트는 이 IP주소로 요청을 보내고 이 IP주소로부터 응답을 받음.

데이터센터에서는 외부로부터 요청이 들어오면 먼저 부하 균등화기(Load Balancer)로 보내고, 로드밸런서는 요청을 호스트로 분배하고 호스트의 현재 부하 상태에 따라서 호스트 간의 부하를 균등하게 함. 

대규모 데이터 센터의 경우 일반적으로 여러 대의 부하 균등화기를 갖고 있으며, 각 부하 균등화기는 특정 클라우드 애플리케이션들을 위해서 사용됨.

부하 균등화기는 패킷의 목적지 IP주소뿐만 아니라 목적지 포트번호(4계층)를 보고 결정하기 때문에 부하 균등화기를 "4계층 스위치"라고도 함.
